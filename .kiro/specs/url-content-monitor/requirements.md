# 需求文档

## 简介

URL内容监控器是一个桌面应用程序，允许用户配置规则来定期访问指定的URL，提取响应内容，并在内容发生变化时通过系统通知提醒用户。该应用程序旨在帮助用户自动监控网页内容的变化，无需手动刷新。

## 术语表

- **应用程序 (Application)**: 指URL内容监控器桌面应用程序
- **监控规则 (Monitor Rule)**: 用户定义的配置，包含URL、提取规则、检查频率等信息
- **内容提取器 (Content Extractor)**: 从HTTP响应中提取特定内容的组件
- **通知系统 (Notification System)**: 向用户发送系统级通知的组件
- **调度器 (Scheduler)**: 根据配置的时间间隔执行监控任务的组件
- **配置管理器 (Configuration Manager)**: 管理和持久化监控规则的组件

## 需求

### 需求 1

**用户故事:** 作为用户，我想要配置多个监控规则，以便同时监控多个不同的URL

#### 验收标准

1. 应用程序应当提供用户界面以创建新的监控规则
2. 应用程序应当允许用户为每个监控规则指定目标URL
3. 应用程序应当允许用户为每个监控规则添加描述信息
4. 应用程序应当允许用户为每个监控规则设置检查间隔时间（使用duration格式，如5m、1h）
5. 应用程序应当允许用户为每个监控规则配置HTTP方法（GET、POST、PUT、DELETE等）
6. 应用程序应当允许用户为每个监控规则添加自定义HTTP请求头
7. 应用程序应当允许用户为每个监控规则配置请求体（用于POST、PUT等方法）
8. 应用程序应当将所有监控规则持久化存储到配置文件中
9. 当应用程序启动时，配置管理器应当加载所有已保存的监控规则

### 需求 2

**用户故事:** 作为用户，我想要定义内容提取规则，以便只关注响应中的特定部分

#### 验收标准

1. 应用程序应当支持CSS选择器作为内容提取方式
2. 应用程序应当支持正则表达式作为内容提取方式
3. 应用程序应当支持JSON路径作为内容提取方式（当响应为JSON格式时）
4. 当用户配置监控规则时，应用程序应当允许用户选择提取方式并输入提取表达式
5. 当内容提取失败时，应用程序应当记录错误信息

### 需求 3

**用户故事:** 作为用户，我想要应用程序定期自动访问配置的URL，以便无需手动刷新

#### 验收标准

1. 当监控规则被激活时，调度器应当按照配置的时间间隔发起HTTP请求
2. 调度器应当支持同时运行多个监控任务
3. 当HTTP请求失败时，应用程序应当记录错误并在下一个周期重试
4. 应用程序应当支持暂停和恢复单个监控规则
5. 应用程序应当支持停止所有监控任务

### 需求 4

**用户故事:** 作为用户，我想要查看提取的内容，以便了解当前的监控结果

#### 验收标准

1. 应用程序应当在用户界面中显示每个监控规则的最新提取内容
2. 应用程序应当显示每个监控规则的最后更新时间
3. 应用程序应当显示每个监控规则的当前状态（运行中、已暂停、错误）
4. 当用户选择特定监控规则时，应用程序应当显示该规则的详细信息
5. 应用程序应当支持手动触发单次内容检查

### 需求 5

**用户故事:** 作为用户，我想要在监控内容发生变化时收到通知，以便及时了解更新

#### 验收标准

1. 当内容提取器检测到提取内容与上次结果不同时，通知系统应当发送系统通知
2. 系统通知应当包含监控规则的名称
3. 系统通知应当包含变化的简要描述或新内容的预览
4. 应用程序应当允许用户为每个监控规则启用或禁用通知功能
5. 应用程序应当在首次提取内容时不发送通知（仅在后续变化时通知）

### 需求 6

**用户故事:** 作为用户，我想要编辑和删除已有的监控规则，以便管理我的监控配置

#### 验收标准

1. 应用程序应当允许用户修改现有监控规则的所有配置项
2. 应用程序应当允许用户删除监控规则
3. 当用户修改监控规则时，应用程序应当保存更改到配置文件
4. 当用户删除监控规则时，应用程序应当从配置文件中移除该规则
5. 当监控规则正在运行时被修改，应用程序应当重启该监控任务以应用新配置

### 需求 7

**用户故事:** 作为用户，我想要应用程序在后台运行，以便不影响我的其他工作

#### 验收标准

1. 应用程序应当支持最小化到系统托盘
2. 当应用程序在系统托盘中时，调度器应当继续执行监控任务
3. 应用程序应当在系统托盘图标上提供右键菜单以快速访问常用功能
4. 当用户点击系统托盘图标时，应用程序应当显示主窗口
5. 应用程序应当在用户关闭主窗口时最小化到托盘而不是退出（除非用户明确选择退出）
